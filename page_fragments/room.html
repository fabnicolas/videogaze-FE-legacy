<head>
    <link href="http://vjs.zencdn.net/6.6.3/video-js.css" rel="stylesheet">
  
    <!-- If you'd like to support IE8 -->
    <script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
</head>

<div class="content" id="video_player_container">
</div>

<script type="text/javascript">
    JSLoader.load("room.js",function(){
        JSLoader.load("video_player.js",function(){
            var roomcode=document.getElementById("spa-var--roomcode").innerHTML;
            Room.init(roomcode,function(response){
                if(response.status==1){
                    if(!response.message.hasOwnProperty("roomcode")) response.message.roomcode = roomcode;
                    set_room_content(response.message);
                }
            });
        });
    });

    function set_room_content(room_data){
        VideoJSPlayer.init(function(){
            document.getElementById("spa-var--roomcode").innerHTML = room_data.roomcode;
            window.history.replaceState({} , 'VideoGaze', './index.php?roomcode='+room_data.roomcode);
            document.getElementById("spa-var--video_to_play").innerHTML = room_data.stream_key;
            var video_to_play=document.getElementById("spa-var--video_to_play").innerHTML;
            VideoJSPlayer.inject_video_player(
                document.getElementById("video_player_container"),
                "my_video",
                video_to_play,
                (room_data.stream_isplaying==1 ? "autoplay": ""),
                function(){
                    Room.attach_videojs_handler("my_video");
                }
            );
        });
    }
</script>